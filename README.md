# Расчетно-пояснительная записка

## Тема и целевая аудитория

В качестве типа сервиса для проектирования я выбрал маркетплейс **Яндекс Маркет**. Данный сервис отвечает требованиям к теме:

- **Имеет реальные аналоги**, доказывающие существование рыночной ниши — Ozon, Wildberries, Купер.
- **Аудитория сервиса** свыше 1 миллиона активных пользователей по данным [inclient.ru](https://inclient.ru/yandex-stats).
  
  | Яндекс Маркет           | Количество  |
  |-------------------------|-------------|
  | **Активные покупатели** | 18.2 млн    |
  | **Активные продавцы**   | 80.6 тысяч  |

- Наибольшим спросом **Яндекс Маркет** пользуется в России (94.48% интернет-трафика), Беларуси (0.97%), Узбекистане (0.74%) и Казахстане (0.73%).
- **Имеет сложную, нетривиальную архитектуру**.

## Функционал

Ключевой функционал для данного сервиса:

1. **Поиск и фильтрация товаров**
   - Система поиска использует **алгоритмы машинного обучения** для более точного подбора результатов на основе предпочтений пользователя. Это также включает умные фильтры, которые позволяют пользователям быстро находить подходящие товары.

2. **Система отзывов и рейтингов**
   - Интегрированная система отзывов с **верификацией подлинности** (например, отзывы только от пользователей, которые действительно купили товар) и **фильтры для сортировки отзывов** по полезности, дате или оценке.
  
3. **Рекомендации товаров в ленте**
   - **Рекомендации товаров в ленте** на основе пользовательских просмотров и ранее совершенных покупок. Это позволяет персонализиовать ленту товаров для пользователя и его удобства.

4. **Оформление заказа**
   - Возможность выбора из нескольких вариантов доставки (курьером, в пункт выдачи, постамат) и множества способов оплаты (банковские карты, электронные кошельки, наложенный платеж). Платформа также предлагает **расчёт стоимости доставки** и позволяет пользователям сохранять несколько адресов доставки.

5. **Сравнение товаров**
   - **Сравнение товаров** с выделением ключевых характеристик и различий, что помогает пользователям принять обоснованное решение.

6. **Управление учетной записью и заказами**
   - **Личный кабинет** с возможностью настройки профиля, просмотра истории покупок и отслеживания текущих заказов.

## Сокращение до MVP

Для создания MVP (минимально жизнеспособного продукта) Яндекс Маркета можно урезать функционал до следующих ключевых функций:

1. **Поиск и фильтрация товаров** (с базовыми фильтрами).
2. **Система отзывов и рейтингов** (с текстовыми отзывами и оценками).
3. **Рекомендации товаров в ленте**.
4. **Оформление заказа** (с одним способом доставки и оплаты).
5. **Сравнение товаров** (базовое сравнение двух товаров по ключевым характеристикам).
6. **Управление учетной записью и заказами** (с основными функциями).
## Расчет нагрузки
### Продуктовык метрики
- **MAU** - 30,66 млн (https://dzen.ru/a/ZkT8wKCKkBgtJMT-)
- **DAU** - 8,76 млн

Данные о товаре на Яндекс Маркете необходимые для его публикации (https://yandex.ru/support2/marketplace/ru/assortment/fields/)
  | Данные           | Размер (предполагаемый)  |
  |---------|-------------|
  | **SKU** | 0.51 КБ    |
  | **Название**   | 0.51 КБ |
  | **Изображения**   | 30*10 МБ  |
  | **Фото 360**   | 72*10 МБ  |
  | **Видео**   | 3*60 МБ  |
  | **Описание**   | 12 КБ  |
  | **Категория товара**   | 0.2 КБ  |
  | **...**   | ...  |
  
Размеры в мегабайтах:
0.00051 + 0.00051 + 300 + 720 + 180 + 0.012 + 0.0002 = 1200.02321 МБ.

Округлим до 1200 МБ, потому как так еще остались возможные характеристики товаров, но по сравнению с размерами медиа-файлов их размел мал.
Таким образом, предполагаемый общий объем данных составляет около 1200 МБ, или 1.2 ГБ.*

>*Яндекс не храниит большие размеры медиа-файлов, а сжимает до нескольких копий для разного размера экрана:
>
> **Изображения:**
> | Размер изображения | Память                |
> |--------------------|-----------------------|
> | 190×250            | 0.14 МБ               |
> | 240×320            | 0.23 МБ               |
> | 300×400            | 0.36 МБ               |
> | 351×468            | 0.49 МБ               |
> | 402×536            | 0.65 МБ               |
> | 450×600            | 0.81 МБ               |
> | 501×668            | 1.00 МБ               |
> | 552×736            | 1.22 МБ               |
> | 600×800            | 1.44 МБ               |
> | **Всего сумма**    | **6.34 МБ**           |
>
>  **Видео:**
> | Тип данных         | Разрешение  | Память                |
> |--------------------|-------------|-----------------------|
> | Прелоад изображения | 600×800     | 1.44 МБ               |
> | Первоначальный кадр видео | 1080×1920 | 6.22 МБ               |
> | Стриминг видео (прогрессивный) | Зависит от сегментации и сети | Переменная (зависит от продолжительности и качества) |
> | **Всего (без учёта стрима)**  |             | **7.66 МБ + стрим**  |
>
> Таким образом размеры стоит пересчитать, взяв что в среднем на товар приходится 10 фотографий и 1 видео, а не 30 и 3 соответсвенно: 
> 0.00051 + 0.00051 + 30*6.4 + 24*6,4 + 180 + 0.012 + 0.0002 = 278 МБ.
>
> Это кажется не слишком сильно сократило размер хранения, но это сильно уменьшило размеры подгружаемых файлов файлов, потому загружается только фотография нужного формата для ленты, а видео там нет вообще. Возьмем среднее значение для изображений для ленты 402х556 - 0,65 МБ


Основные действия по функционалу MVP:

  | Действие | Кол-во в день на одного пользователя в среднем  |
  |---------|-------------|
  | **Поиск и фильтрация товаров** | 4 |
  | **Система отзывов и рейтингов**   | 0.51 КБ |
  | **Оформление заказа**   | 0.14 ( 1 в неделю )   |
  | **Сравнение товаров**   | 1 |
  | **Управление учетной записью и заказами**   | 0.14 ( 1 в неделю )  |
  
### Технические метрики
- Хранилище: Количество товаров на Яндекс Маркете - 108 млн (https://yastatic.net/s3/ir-docs/docs/2024/q2/57a1cu049ffbd144aeged36d47h173c2/MKPAO_Press_Release_RUS_rs94k.pdf).
Посчитав до этого сколько примерно нужно на хранение одного товара поолучаем 12.3 петабайта памяти.
- Сетевой трафик
